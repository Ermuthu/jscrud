<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8"></meta>
		<script>

		// a function that tests multiple arrays for 

		// Create, Read, Update, Delete methods will have to be supported
		// as items are created they will first have to be indexed

		// added comments so I can do a second commit
		var holder = {};

		var indices = {};

		var indexObject = function(item){
			for (key in item){
				if (!(key in indices)){
					// this is the first time the program has encountered this key, create an index in indices for it
					indices[key] = {};
				};
				// the index for each key now definitely exists
				var indx = indices[key];
				var value=item[key];

				if (value in indx){
					// the name is already in the index, add item's uid to index array
					indx[value].push(uid);
				} else {
					// this is the first time the name has been encountered, create a new array with this name by itself
					indx[value] = [uid];
				}	
			}
		};


		var filterArrays = function(arrayList){
			// the shortest uid array passed in should be the source for all tested uids
			// by definition, any item in the intersection of all arrays must be in the shortest array
			// create an array to hold matched uids
			var matches = [];
			if (arrayList.length === 1){
				// if only one uid array was passed in, return it, we're done
				return arrayList[0];
			}
			// find the shortest array:
			var testArray = arrayList.sort(function(a,b){
				return a.length - b.length;
			})[0];
			testArray.forEach(function(uid){
				var matchFlag = true;
				arrayList.forEach(function(testAgainst){
					if (testAgainst.indexOf(uid)===-1){
						matchFlag = false;
					}
				})
				if (matchFlag === true){
					matches.push(uid);
				}
			})
			return matches;
		}


		var matchObject = function(item){
			var indxHits = [];
			for (key in item){
				var value = item[key];
				alert(value);
				if (key in indices){
					// if there is an index defined for the matching object, push the uid's in the index array and into the indxHits array
					var indx = indices[key];
					var hit = indx[value];
					indxHits.push(hit);
				} else {
					// there is no index defined for some key in the matching object, therefore there is no match, return out of the loop
					return undefined;
				}
			}
			// test returned index hits; a uid must be present in all of them to be considered a match
			// return the matched records

			console.log(indxHits);
		}



		var createRecord = function(item){
			// index the object
			indexObject(item);

			// store the object
			var uid=Object.keys(holder).length;
			holder[uid] = item;

		};

		var deleteRecord = function(item){
			// find the object's uid by 
		}

		var updateRecord = function(item){
			// update record
		}

		var readRecord = function(item){
			// find and return a record
		}

		var moshe = {first:'moshe', last:'bildner'};
		var luke = {first:'moshe', last:'trapp'};
		
		// testing code

		// createRecord(moshe);
		// createRecord(luke);

		// alert(matchObject(luke));


		// alert(matchObject({
		// 	first:'moshe',
		// 	middle:'hillel',
		// 	last:'bildner'
		// }));


		</script>
	

	</head>


</html>
